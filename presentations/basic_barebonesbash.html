<!DOCTYPE html>
<html>
  <head>
    <title>Basic Bare Bones Bash</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Maven+Pro:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700);
      @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700);

      /* font/size formatting */
      body { 
        font-family: 'Roboto', sans-serif;
        font-weight: 300;
        color: #000000;
      }
      
      h1, h2, h3 {
        font-family: 'Libre Baskerville', sans-serif;
      }

      h3 {
        color: #999999;
        font-size: 20px;
      }
        .cols {
        display: flex;
      }

      blockquote {
        border-left: 0.3em solid #ccc;
        padding: 0 15px;
        font-style: italic;
        color: #ccc;
        quotes: "\201C""\201D""\2018""\2019";
        font-size: 14px;
      }

      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; color: grey}
      
      /* Two-column layouts */
      .left-column  { width: 49%; float: left; }
      .right-column { width: 49%; float: right; }

      .left-column-33  { width: 33%; float: left; }
      .right-column-66 { width: 66%; float: right; }

      .left-column-66  { width: 66%; float: left; }
      .right-column-33 { width: 33%; float: right; }

      .center-column-33 { width: 33% float: middle; }

      .right-column ~ p { clear: both; }
      .right-column ~ ul { clear: both; }

      /* use with e.g. <div class=vertical-center"> */
      .vertical-center {
         margin: 0;
         position: absolute;
         top: 50%;
         -ms-transform: translateY(-50%);
         transform: translateY(-50%);
      }


      .vertical-center-with-title {
         margin: 0;
         position: absolute;
         top: 60%;
         -ms-transform: translateY(-50%);
         transform: translateY(-50%);
      }


      /* For progress bar */
      .remark-slide-number {
        position: inherit;
      }

      .remark-slide-number .progress-bar-container {
        position: absolute;
        bottom: 0;
        height: 4px;
        display: block;
        left: 0;
        right: 0;
      }

      .remark-slide-number .progress-bar {
        height: 100%;
        background-color: red;
      }

    </style>
  </head>
  <body>
    <textarea id="source" bar>

class: center, middle

## **Basic** Bespoke 
# BARE BONES BASH 
## Brought By Bearded Bioinformaticians

### Thiseas C. Lamnidis and James A. Fellows Yates

---

# Who are we?
.left-column-66[
### ~~Bowser~~ James

- BSc. @ Department of Archaeology (York)
- MSc. @ Institute for Archaeological Sciences (Tübingen)
- Ph.D.(?) @ Department of Archaeogenetics (Jena)

### ~~Yoshi~~ Thiseas 

- BSc. @ Department of Biology (York)
- MSc. @ Department of Anthropology (Durham)
- Ph.D.(?) @ Department of Archaeogenetics (Jena)
]

.right-column-33[
<div class="vertical-center-with-title">
  <img src=".images/James_JamessDaughter_Thiseas_In_Japan.jpg" width="80%">
</div>
]

---

class: center, middle

.left-column[
# Neither of us...
##...has a computational background
]

--

.right-column[
<div class="vertical-center">
  <p align="center">
    Except in internet memes!
    <img src=".images/science_dog.jpg" width="95%" height = "95%">
  </p>
</div>
]


---

# How did we get here?

How did we learn to do everything you're about to learn?

- Being lazy

--

- Google

--

- Talking to each other

--

- Metric tons of TRIAL AND ERROR (tears, manic screaming, blood...)

---

# Aims of this course

- Aim:
  - To get you comfortable enough with the terminal to try it out

--

- Objectives
  1. What is a terminal?
  2. How to navigate around your computer with the terminal?
  3. How to interact with text files?
  4. How to combine multiple programs into a single command?
  5. How to save file space with shortcuts
  6. What is a variable? What is a for loop?

---

# Future outcomes

- Make your work more efficient
  - Large scale modifications of files
  - Make your work more reproducible
  - Wizardary (stuff that we can't even imagine...)
- Make less mistakes
  - Eliminate huamn error (blame it on the computer!)
- Look like a ~~computer nerd~~ really cool

---

class: center, middle

# Five Commandments of Bare Bones Bash

---

class: middle


.left-column[
# Rule Nr. 1
## Be lazy!
]
.right-column[
Desire for shortcuts motivates you explore more!
]

---

class: middle



.left-column[
# Rule Nr. 2
## ~~Google~~ The Hive-Mind knows everything.
]
.right-column[
- 99% of the time, someone else has already had the same issue.
- Let the poor soul do the work for you!
- (...and pass it on!)
]

---

class: middle



.left-column[
# Rule Nr. 3
## Document everything you do.
]
.right-column[
- Makes future you happy
- Reproducibility
- Helps others!
]

---

class: middle



.left-column[
# Rule Nr. 4
## There will ALWAYS be a typo!
]
.right-column[
- Don't get disheartned, even best programmers make mistakes
- Sometimes the problem _isn't_ you being 'stupid', programmers are crap at documentation
]

---

class: middle



.left-column[
# Rule Nr. 5
## Something to come....
]

---

# Connecting to our server


 * Go to the link provided, on your browser.
 * Log-in with the user and password we provided you. 

---

class: center

<p align="left"><img src=".images/Jupyter1.png" width="100%" ></p>

---

class: center

<p align="left"><img src=".images/Jupyter2.png" width="100%" ></p>

---

class: center

<p align="left"><img src=".images/Jupyter3.png" width="100%" ></p>

---

class: center

<p align="left"><img src=".images/Jupyter4.png" width="100%" ></p>

---

class: center

<p align="left"><img src=".images/Jupyter5.png" width="100%" ></p>

???
What you see here is the "command prompt". username@server:pwd$
me, at the workshop server. ~ means "my HOME directory" (user specific). 

---

class: middle, center

# Always mind the $!

<p align="center"><img title="Source: https://giphy.com/gifs/studiosoriginals-gilphabet-3o84U72tKO389H2lI4" src="https://media.giphy.com/media/3o84U72tKO389H2lI4/giphy.gif" ></p>

???
in Bash ALWAYS MIND THE $. Only copy after the $ so you dont paste the command prompt too. $ is also important when dealing with variables, which you will see later today.

---

# Navigating the maze

As we mentioned, _~_ is your _home directory_. But where _is_ your home?

```bash
$ pwd
```
--
This prints the entire "filepath" of the directory i.e. the route from the "root" 
(a specific directory on the machine), through every subdirectory, leading to your 
particular folder. 

```
/home/thiseas
```

---

# Let's talk about paths!

.left-column-66[
While walking around downtown Jena, you feel a rumble in your belly, and feel a craving that only a _currywurst with sweet potato fries_ can fulfill. 

You look around and see a stranger sitting under __the statue of Kurfürst Johann Friedrich.__ You approach the stranger and ask them for directions to Fritz Mitte!]

.left-column-33[<p align="right"><img src=".images/Jena_Marktplatz_by_C.Loeser.jpg" width="80%" > <figcaption align="right">Photo by C. Loeser. CC-BY</figcaption></p>
]

---

# Absolute paths

.left-column-66[
The location of a file or folder, __from the “root” directory__ (/).

]

.right-column-33[
<p align="center">
  <img src=".images/JenTower_by_Igor_Slovak.jpg" width="80%" > 
  <figcaption align="right">Photo by Igor Slovak. CC-BY-SA</figcaption>
</p>
]

--

.left-column-66[

Equivalent to getting directions to Fritz Mitte, from Jentower (the de facto landmark in Jena).


>___“From Jentower, cross Leutragraben and turn right. You will see FM 100m ahead!”___
<p align="right"><i>Kind stranger, 2019</i></p>
]




???
These directions are true no matter where in town you happen to be.

--

.left-column-66[
__Absolute__ paths always start with `/`. Paths starting with `~` are also absolute paths, since `~` translates to the absolute path of your specific home directory. That is the directory path you see in the output of the `pwd` command you just ran.
]



---

# Relative paths

.left-column-66[
The location of a file or folder, __from your current directory.__
]

.right-column-33[
<p align="right">
  <img src=".images/Jena_Johannistor_by_Andreas_Praefcke.jpg" width="75%" > 
  <figcaption align="right">Photo by Andreas Praefcke. CC-BY</figcaption></p>
]

--

.left-column-66[

Equivalent getting directions to Fritz Mitte from your current location.

>___“Go down that road, turn left, then keep going straight until you see it!”___
<p align="right"><i>also Kind stranger, 2019</i></p>

]

???
These directions are easier to follow, but only work if you begin AT MARKTPLATZ.

--

.left-column-66[
__Relative__ paths are always relative to your working directory (i.e.
  your current directory). Often this type of path will begin with one (`./`) 
  or two (`../`) dots followed by a forward slash. 
  
> In the syntax of relative paths `.` means "the current directory" and `..` means "the parent directory" (or the 'one above'). 
]


---

# The contents of a directory

Now let's look around at our current location and see what we can find within 
our home directory. We can use the command `ls`, shorthand for "list", which 
will (surprise surprise) list the directory contents.

```bash
$ ls

```
--
This will produce no output, since your current directory is empty. Let's change that!
--
<br>
You can make a new empty directory using the command `mkdir`, shorthand for 
"**m**a**k**e **dir**ectory".

```bash
$ mkdir ~/BareBonesBosh
$ ls ~
```

--
```
BareBonesBosh
```
Now that your home directory is not empty, `ls` has output!

---

# Directory Management

It is important to keep your corner of the computer well organised, and the 
trick to doing that is making your own directories. Often _a lot_ of them. 
--
<br><br>
__But what's this!?! There was a typo in the name of the directory you made!__
<p align="center"><img title="Source: https://giphy.com/gifs/table-flip-ieGdB2g5kDIkg" src="https://media.giphy.com/media/ieGdB2g5kDIkg/giphy.gif" width="25%"> <img title="Source: https://tenor.com/view/it-crowd-moss-computer-throw-gif-5404468" src="https://media.tenor.co/images/d82c7edc4b04227b4c973f24b904695f/raw" width="32%"></p>

--
But don't lose hope, as we can rename things with the `mv` command, 
shorthand for "**m**o**v**e". 

In fact move, as the name suggests, will move a file/folder into a new location, 
also renaming it in the process if necessary. It works by typing `mv`, the old 
location and a target location.

```bash
$ mv ~/BareBonesBosh ~/BearBonesBash

```

---

# Oh no! Not again! 
```bash
$ ls
```
```
BearBonesBash
```
This is not a bash tutorial for ancient __bear__ genomics!
<p align="center">
  <img title="Source: https://giphy.com/gifs/bear-forest-water-IQ9KefLJHfJPq" src="https://media.giphy.com/media/IQ9KefLJHfJPq/giphy.gif" width="20%">
</p>

Let's just delete that empty directory and start over, using the `rmdir` 
command, short for "**r**e**m**ove **dir**ectory".

```bash
$ rmdir ~/BearBonesBash
```

---

# From the beginning...

And now we can create our directory, properly named this time.

```bash
$ mkdir ~/BareBonesBash
$ ls
```
```
BareBonesBash
```

Much better!

.left-column[
<p align="center">
  <img title="Source: https://giphy.com/gifs/tiktok-bear-tsX3YMWYzDPjAARfeg" src="https://media.giphy.com/media/tsX3YMWYzDPjAARfeg/giphy.gif" width="50%">
</p>
]

.right-column[
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
_\[Tags included: #happy #dancing #bear #sexy (WTF!?!?)_\]
]




---

# Navigating the file system
Now that we have our directory, we should move into it. To do this, we will need to use `cd`, short for __c__hange __d__irectory.

```bash
$ cd BareBonesBash
```
--
You can see that your current directory has changed on your command prompt! (or you can use `pwd`). <br>
--
To move to the parent directory of your current location, you can use:
```bash
cd ..
```
--
You can also use an abosolute path to move to a directory:
```bash
cd ~/BareBonesBash
```
--
> **BONUS TIP TIME!** When 
using `cd` you can use a dash (`-`) to indicate 'my previous location'. This is 
useful since you can traverse _[ha! I have my own fancy words now! - James]_ 
multiple directories with one `cd` command.

---

# Concept: Comments

Try running the following code:
```bash
## Remember in "A land before time" when the dinosaur's mother died?
```
--
While reading that command, you 
might have been reminded of one of the most emotionally devastating moments of 
any person's life. <p align="center"><img title="Source: https://www.buzzfeed.com/bradesposito/sad-before-time?utm_term=.cjY4banJZ#.ixJ815NjJ" src="https://img.buzzfeed.com/buzzfeed-static/static/2015-04/29/21/enhanced/webdr15/anigif_enhanced-31175-1430357953-19.gif" width="35%"></p>
--
<br>However, the computer would show no signs of emotional 
struggle whatsoever, because it __ignores 
anything that comes after a _comment character_, which in bash is a hash (`#`).__
???
You can use comments to explain what a certain bit of code 
does, without affecting how that code runs. This can also be a useful lifehack 
in certain situations, an example of which will be given later.

---

class: center,middle
# Playing with the files, one bit at a time

---

# Time to play!


.left-column[

- We have a place to organise our files... but no files :\

- We aren't playing with bears today
  > That's dangerous! 

  - Lets play with some Mammoths instead!
  ]

.right-column[
<p align="center">
  <img title="Source: https://giphy.com/gifs/sid-ice-age-a-mammoth-christmas-kbuQOkATEo6VW" src="https://media.giphy.com/media/kbuQOkATEo6VW/giphy.gif"> 
  <img title="Source: https://giphy.com/gifs/3o6Zte5Q11lxAu8Q5q" src="https://media.giphy.com/media/3o6Zte5Q11lxAu8Q5q/giphy.gif" width = "65%">
</p>
] 

---

# Downloading files with `wget`

We are going to download a FASTQ file from the ENA (European Nucleotide Archive). This should be pretty quick!

> For non-squishy dead thing nerds: a FASTQ file is just a text file with DNA molecule sequences and extra metadata


<p align="center">
  <img title="Source: https://giphy.com/gifs/mario-kart-lAIbbDbcXSZSU" src="https://media.giphy.com/media/lAIbbDbcXSZSU/giphy.gif" width="20%">
</p>

--

```bash
## Download!
$ wget ftp.sra.ebi.ac.uk/vol1/fastq/ERR202/001/ERR2020601/ERR2020601.fastq.gz

## Then to check if the file is now in our working directory
$ ls

```

---

# Organise yo' stuff!

Use `mv` as it should be used, and move your newly downloaded file into your workshop folder.

Then check to see if it moved!

--

```bash
$ mv ~/ERR2020601.fastq.gz ~/BareBonesBash
$ ls
```

--

.left-column-33[

You should now see that the fastq file is no longer in your home folder.
]

.right-column-66[
<p align="center">
  <img title="Source: https://giphy.com/gifs/fallontonight-dogs-disappear-poof-5ZYx8Zng64KBowFvLQ" src="https://media.giphy.com/media/5ZYx8Zng64KBowFvLQ/giphy.gif" width="50%">
</p>
]

---

# But where did it go?!

Lets see if it went to were we told it to go...

--

```bash
$ cd ~/BareBonesBash
$ ls 
```

Good, the file arrived in `~/BareBonesBash/` safely!  But what is in it?

---

# Meow 

.left-column[
In bash, you can normally use 
`cat` with text files, short for con**cat**enate, which is used to print the 
contents of a file to the screen. Lets try this with our newly downloaded file.
]

.right-column[
<p align = "center">
<img title="Source: https://giphy.com/gifs/meow-descriptive-noise-x4YHSKRpYQhLq" src="https://media.giphy.com/media/x4YHSKRpYQhLq/giphy.gif" width = "90%"> 
</p>
]

--


.left-column[
```bash
$ cat ERR2020601.fastq.gz
```
]

.right-column[
> **BONUS TIP TIME!** If you're anything like Thiseas, who gets triggered at slow 
computer things, and prefer to have the computer do the work for you - try 
typing a couple of characters then press the "TAB" key on your keyboard.
]

--

.left-column[
```
��'��x��xI��-�����2��u�_SuY�9A�}W.��
Zf��?���}H����9�Kɰ�
����l�B��stݹlfDt������-L��|x:�MU
tI����u�1������"d�H
```
]

---

layout: false

# Oh...

.left-column[
- You probably had a bunch of junk printed to screen or nothing displayed 
  - just press enter to cancel
  ]

--

.right-column[
<p align="center">
  <img title="Source: https://giphy.com/gifs/kQbMO5X7UA1C8" src="https://media.giphy.com/media/kQbMO5X7UA1C8/giphy.gif", width="80%">
</p>
> Looks like curiosity killed the `cat`!
]

--

.left-column[
- That's because the FASTQ file, as with almost all FASTQs, is compressed 
  - as indicated by the `.gz`
]

---

## Viewing the gz

To view the _human readable_ contents of the file, we 
can instead use `zcat`. Don't forget your auto-complete!

--

```bash
$ zcat ERR2020601.fastq.gz

```

--

```
@ERR2020601.147099 F_AHSTEUER006:166:C5UJMANXX:8:2109:2222:68258/1
TCTGCGTCCGTCATATCTATTGCCCAGTCACTAGTCACTAGTCA
+
3:3AAEFGGGGGGGGGGGEGGCDGGGBGGGGGFGFGEGGGGGGG
@ERR2020601.147100 F_AHSTEUER006:166:C5UJMANXX:8:1315:17303:82366/1
TGGTCGCTGCCGCGAGCGGATTCCTGCTGA
+
3B=@BECGGGGGGGGGGGGGGGGGGGGGGG
```

That looks much better, we can now actually see some DNA sequences! 

--

> **BONUS TIP TIME!** try pressing `ctrl+l`, which will clear your terminal of 
> all the junk that was printed to your screen. This does NOT delete those lines, 
> it simply scrolls down for you. You can still find all your previous work if
> you scroll up.

---

class: center,middle
# Asking the computer for help (it loves helping people)

A.K.A. when your tutor thinks of a very (un)funny metaphor to explain something!

---

## Yeah, but what EXACTLY is compression?

.left-column[
- Compression is a way of saving hard-disk space
  - finds common patterns and replace with a smaller (repeated)-value
  - later translated back (decompression)
]

-

.right-column[
<p align="center">
  <img title="Source: https://giphy.com/gifs/via-exhaust-intake-1rb6ylm4QCUaA
" src="https://media.giphy.com/media/1rb6ylm4QCUaA/giphy.gif" width="50%">
<p>
]

--

.left-column[
For example - take a time machine back to 2001, when having one of 
these things...
]

--

.right-column[
<p align="center">
  <img title="Source: https://everymac.com/systems/apple/ipod/specs/ipod.html" src="https://everymac.com/images/cpu_pictures/apple_ipod.jpg" width="40%">
</p>
]

--

.left-column[
made you instantly popular and better geared than James Bond _\[tech-savvy 
Pierce Brosnan, not the trigger-happy Daniel Craig]_
]

---

# Muzak!

.left-column[
This iPod had a space of 5GB
 - Average uncompressed album: 640MB
 - Fits: 7.8125 Albums  
 - 20 songs per album \[_because Thiseas just listens to Disney soundtracks..._\]
 - Only 160 songs in total
]

.right-column[
<p align="center">
  <img title="Source: https://everymac.com/systems/apple/ipod/specs/ipod.html" src="https://everymac.com/images/cpu_pictures/apple_ipod.jpg" width="60%">
</p>
]

--

_But I had 800 songs, and still had space_ - we hear you call?
- Because of compression!
- MP3 is a another type of compression specifically for music files

---

# Ok cool, but back to computers...

How to find out how much space our FASTQ has? 
  - Let's ask the computer to help us find a way! 

First - how to find out what a program does? Ask `whatis`!

```bash
whatis man
```

--

```
man (1)              - an interface to the on-line reference manuals
```

.left-column-33[

<br/>
<br/>
Wait... what is this? MANUALS!? OMG!?


]

.right-column-66[
<p align="center">
  <img title="Source: https://giphy.com/gifs/baby-story-reading-8dYmJ6Buo3lYY" src="https://media.giphy.com/media/8dYmJ6Buo3lYY/giphy.gif" width="50%">
</p>
]

---



Now we can read what zcat does!

```bash
man zcat

```

--

```
GZIP(1)                     General Commands Manual                    GZIP(1)

NAME
       gzip, gunzip, zcat - compress or expand files

SYNOPSIS
       gzip [ -acdfhklLnNrtvV19 ] [--rsyncable] [-S suffix] [ name ...  ]
       gunzip [ -acfhklLnNrtvV ] [-S suffix] [ name ...  ]
       zcat [ -fhLV ] [ name ...  ]

DESCRIPTION
       Gzip  reduces  the  size  of  the  named  files using Lempel-Ziv coding
       (LZ77).  Whenever possible, each file  is  replaced  by  one  with  the
       extension .gz, while keeping the same ownership modes, access and modi‐
       fication times.  (The default extension is -gz for VMS,  z  for  MSDOS,
       OS/2  FAT, Windows NT FAT and Atari.)  If no files are specified, or if
       a file name is "-", the standard input is compressed  to  the  standard
       output.  Gzip will only attempt to compress regular files.  In particu‐
       lar, it will ignore symbolic links.

```

- To navigate:
  - Scroll up and down with arrow keys
  - Quit press `q` on your keyboard

Scroll until you see `OPTIONS` - what does `--list` do?

---

# Oooooooh

The option `-l` lists 
  - the size of a file in both compressed and uncompressed form
  -as well as the compression ratio (how effective the 
compression was). 

--

**Most programmes you will use DO have a `man` page, making this command 
extremely useful.**.

--

 Now that we learned about the `-l` option of `gzip`

```bash
gzip -l ERR2020601.fastq.gz

```
--
```
         compressed        uncompressed  ratio uncompressed_name
             217232              864983  74.9% ERR2020601.fastq
```

A compression factor of `74.9%` is pretty good. It means our compressed FASTQ file is 
25.1% the size of the uncompressed file would.

---

class: center,middle
# The Lord of the Pipes: One command to do them all.

--

### Piping

---

# Ceci n'est pas une pipe

After that tangent, let's get back to our regularly scheduled program(ming)!

--

Now we will get familiar with the most important functionality of bash: the
concept of the `|` (a.k.a the "pipe")

<p align="center">
  <img title="Made with EZGif.com" src="../docs/.gifs/Boromir.gif" > 
</p>
<p align="center">
  <img title="Source: https://tinynin.wordpress.com/2012/01/08/marioportal-warp-pipe/" src="https://tinynin.files.wordpress.com/2012/01/warppipe-copy.gif" width = "30%" >
</p>

---

# Pass the parcel

- A pipe passes the output of one command and gives it as input to the next. 
- It allows us to string multiple commands together, one after the other, 
  - which means you can do more complicated (and beautiful) things to your files "on the fly". 

--

Lets try this out with new new commands

.left-column[
- `head` 
  - shows first 10 lines of a file
- `tail` 
  - shows the last 10 lines. 
]
.right-column[

<p align="center">
<iframe align="center" src='https://gfycat.com/ifr/MeekWarpedAsiandamselfly' frameborder='0' scrolling='no' allowfullscreen></iframe> 
</p>
]


---

# Tiene cabeza...

We will now print the file to screen with `zcat`, but rather than just let 
the whole thing print, we will "pipe" the output into `head`, which will 
allow us to see just the first 10 lines.

> Don't forget your auto-complete with the tab key!

```bash
$ zcat ERR2020601.fastq.gz | head

```

--

We can also display more lines with the `-n` flag (short for "**n**umber of 
lines"). To see the first 20 lines you would use 

> **Bonus tip time** you can press up and down on your keyboard buttons to
view previous commands!

```bash
$ zcat ERR2020601.fastq.gz | head -n 20

```

---

# ...y tiene cola

The same option exists for tail, note that but options are not universal! Not 
every programme will use the same options!

```bash
$ zcat ERR2020601.fastq.gz | tail -n 4

```

--

And you can also chain them altogether _\[not unlike a human centipede... No 
gif here so we don't get fired]_

--

```bash
$ zcat ERR2020601.fastq.gz | head -n 20 | tail -n 4
```

The above command will print the whole file, but capture only the first 20 
lines, before printing out the last 4 lines of these 20.

<p align="center"><img title="Made with EZGif.com" src="../docs/.gifs/frodo.gif" width="30%" height="20%"></p>

---

# Slow down dude...

But what if you wanted to view the whole file "at your own leisurely pace"

<p align="center">
  <img title="Source: https://giphy.com/gifs/stroll-82abB3W2DknkY" src="https://media.giphy.com/media/82abB3W2DknkY/giphy.gif" width="20%">
</p>

We can use the tool `less`, which prints the file to screen, but allows you 
to move up and down the output with your `arrow keys`. You can also move down 
a full screen with the `spacebar`.

```bash
$ zcat ERR2020601.fastq.gz | less

```

To quit the viwer: press "q" on your keyboard.
---


# Hold your horses... what does all this junk mean!?

In practice, what was just printed on your screen is the record of a single DNA 
molecule, which spans 4 lines of the FASTQ file. 

--

* The record begins with the read ID, preceded by an `@`, given by the sequencing machine

--

* The next line contains the actual DNA sequence of the read. 

--

* The third line is a separator line ('`+`'). 

--

* Finally, the fourth line of this record contains the base quality score for each position on the read, encoded a certain way.  (again something the sequencer)

---

# lol wut?

Don't worry if this makes no sense...

--

The important thing is that there is a repeated structure in the file (in this 
case a collection of lines with the same structure for each DNA molecule)


Why does this matter?

--

.left-column[
## This means PATTERNS!
]

.right-column[
<p align="center">
  <img title="Source: https://giphy.com/gifs/WgO1QdDfTooxrEsfES" src="https://media.giphy.com/media/WgO1QdDfTooxrEsfES/giphy.gif" width="80%">
</p>
]

---

class: center,middle
# The Lord of the Pipes: One command to do them all.

### Word Count 

_\[no, not in your manuscript, don't panic!\]_

---


# Counting

.left-column[
A first question a bioinformatician might have is how many DNA molecules are 
in my file?
]

.right-column[
<p align="center">
  <img title="Source: https://giphy.com/gifs/l41YtZOb9EUABnuqA" src="https://media.giphy.com/media/l41YtZOb9EUABnuqA/giphy.gif" width="50%">
</p>
]

--

We can count certain attributes of a text file with `wc` 
- which stands for "**w**ord **c**ount".

--

But we want lines! Give the option `-l`

```bash
$ zcat ERR2020601.fastq.gz | wc -l
```

```
18880
```

> Example for non-geneticists: how many entries in a table do you have? 

---

# But DNA molecules FASTQ have four lines!

How can we be lazy and avoiding doing _acutal maths_ (ew)?

--
<br>
<p align="center">
  <img title="Source: https://giphy.com/gifs/WgO1QdDfTooxrEsfES" src="https://media.giphy.com/media/WgO1QdDfTooxrEsfES/giphy.gif" width="30%">
</p>
<p align="center"><b>What is a common PATTERN in the file?</b></p>


---

# But DNA molecules FASTQ have four lines!

> * The record begins with the read ID, preceded by an `@`, given by the sequencing machine

--

Lets count each line with a `@` in it!

<p align="center">
  <img title="Source: https://giphy.com/gifs/season-16-the-simpsons-16x3-3orieUe6ejxSFxYCXe" src="https://media.giphy.com/media/3orieUe6ejxSFxYCXe/giphy.gif" width="50%">
</p>


---


# Grep

To search for a particular character or string in a text file we can use 

`grep`


This prints only lines in a file that match a certain pattern.

--

For example

```bash
$ zcat ERR2020601.fastq.gz | grep @

```

Results in...

-- 

```
@ERR2020601.147096 F_AHSTEUER006:166:C5UJMANXX:8:1215:14390:82061/1
AB@BBGGGGGGGGGGGGGGGEFGGGGGGGGGGGGGFGGGGG>GGGGGGGGGGAFGGGGGGGGGGGG
@ERR2020601.147097 F_AHSTEUER006:166:C5UJMANXX:8:1301:14633:50792/1
@ERR2020601.147098 F_AHSTEUER006:166:C5UJMANXX:8:1210:12875:93069/1
@ERR2020601.147099 F_AHSTEUER006:166:C5UJMANXX:8:2109:2222:68258/1
@ERR2020601.147100 F_AHSTEUER006:166:C5UJMANXX:8:1315:17303:82366/1
3B=@BECGGGGGGGGGGGGGGGGGGGGGGG
```

---

# Close but no cigar...

Unfortunately we seem to have picked up some other stuff because of the @ 
characters in the sequence quality lines. 

--

We can therefore use a more specific _string_ to ensure we print stuff want.

--

In this case, each read ID begins with '@ERR'

```bash
$ zcat ERR2020601.fastq.gz | grep @ERR | less
```

--

Scroll up and down - this looks better, doesn't it?!

> Remember to press your q key to quit `less`!

---

## ding ding ding - Round TWO!

Lets now try and count the number of read IDs, to find the number of DNA 
molecules in our file

```zcat
$ zcat ERR2020601.fastq.gz | grep @ERR | wc -l

```
--
```
4720
```

<p align="center">
  <img title="Source: https://giphy.com/gifs/cheer-cheering-11sBLVxNs7v6WA" src="https://media.giphy.com/media/11sBLVxNs7v6WA/giphy.gif">
</p>

> That's the right number, trust us ;)

---

class: center,middle
# Now you're thinking with portals! Symlinks and their usefulness 

---

THISEAS Do me! (The slide I mean...)

---

class: center,middle
# Laziness 101: Minimising our work by maximising the work of the computer

--

### Text Editing in the Terminal

---

# One sample ain't enough


<p align="center">
  <img title="Source: https://giphy.com/gifs/reaction-FyKfqRxVbzciY" src="https://media.giphy.com/media/FyKfqRxVbzciY/giphy.gif">
</p>

Lets get 7 more!

--

But typing the same `wget` command over and over isn't being lazy!

--

Instead, we can supply `wget` a text file, with the link to each new FASTQ file.

```bash
$ wget -i <LIST_OF_URLS>.txt
```

---

# Text editing

.left-column[
But how can we make this file? 
]

.right-column[
<p align="center">
  <img title="Source: https://giphy.com/gifs/aww-tiny-hiss-Y9F87zGXhb7zi" src="https://media.giphy.com/media/Y9F87zGXhb7zi/giphy.gif" width = "100%">
</p>

]

--

.left-column[
If you're absolutely insane you may look up `vim` 
_\[Thiseas' poison\]_, or we can use `nano` which is much more user friendly.
]

--

.left-column[
- `nano` is a text editor
  - Similar to `TextMate`, `gedit` or `notepad`
  - But runs in your terminal
  - Main difference: how you 'save', 'close' etc.
  - These are controlled with special key combinations 
      - e.g. ctrl + c to copy text in word
]

---

# Lets do eet!

So open up the program with

```bash
$ nano
```
--

- Try typing something!
- Look at the bottom of the window
  - These correspond to different commands (save, exit, etc.)
  - `^` corresponds to your `ctrl` or `cmd` keys on your keyboard
- Move around with your arrow keys.

--

- To save the contents of your file
  1. Initiate exit with `ctrl + x`
  2. You will be prompted to 'Save modified buffer'.
  3. Press `y` on your keyboard to agree
  4. Set the file name as `~/BareBonesBash/Ftp.Link.txt`
  5. Press `enter` to save

All done!

---

# Not ANOTHER typo!?

We can check that the file was successfully generated by navigating into 
the directory and doing `ls`.

```bash
$ cd ~/BareBonesBash/
ls

```
--

Great! There is a file there! But wait! OH NO! There is another typo! We 
want to have multiple _links_ not a Link!

<p align="center">
  <img title="Source: https://giphy.com/gifs/the-legend-of-zelda-link-funny-RkymcOKhoCRTG" src="https://media.giphy.com/media/RkymcOKhoCRTG/giphy.gif" width="45%">
  <img title="Source: https://giphy.com/gifs/link-the-legend-of-zelda-NVBR6cLvUjV9C" src="https://media3.giphy.com/media/NVBR6cLvUjV9C/giphy.gif" width="30%">
</p>

Lets remove that file, and start again. 

---

# Delete...

.left-column[
So far, we learnt `rmdir` to remove a directory. 

To remove a file, we can instead use `rm` for – you guessed it! – **r**e**m**ove. 
]

--

.right-column[
<p align="center">
  <img title="Source: https://giphy.com/gifs/trash-desktop-delete-pHWPC1N5IZGVTfRgsN" src="https://media.giphy.com/media/pHWPC1N5IZGVTfRgsN/giphy.gif">
</p>
]

.left-column[
```bash
$ rm Ftp.Link.txt
$ ls
```
And it's gone!
]

---

# Anyway...

Now we've fixed our typo 

1. Open `nano` again
2. Go to [https://tinyurl.com/BBB-FtpLinks](https://tinyurl.com/BBB-FtpLinks) in your \[_real life_\] internet browser
3. Copy the text on the webpage
4. \[_back down the rabbit hole_\] paste the text into `nano`

> Note the `#`, this means the line is **commented out** as we've already downloaded this file!

--

.left-column-66[
So again to recap exiting and save a file in nano we do the following dance: 
  1. Initiate exit with `ctrl + x`
  2. You will be prompted to 'Save modified buffer'.
  3. Press `y` on your keyboard to agree
  4. Set the file name as `~/BareBonesBash/Ftp.Link.txt`
  5. Press `enter` to save
]

.right-column-33[
  <p align="center">
  <img title="Source: https://giphy.com/gifs/dancing-dance-star-wars-6fScAIQR0P0xW" src="https://media.giphy.com/media/6fScAIQR0P0xW/giphy.gif">
</p>
]

---

# Did it save?

How can we check that the links saved correctly?

--

<p align = "center">
<img title="Source: https://giphy.com/gifs/meow-descriptive-noise-x4YHSKRpYQhLq" src="https://media.giphy.com/media/x4YHSKRpYQhLq/giphy.gif" width = "50%"> 
</p>


```bash
$ cat ~/BareBonesBash/Ftp.Link.txt

```

--

```
ftp.sra.ebi.ac.uk/vol1/fastq/ERR202/009/ERR2020609/ERR2020609.fastq.gz
ftp.sra.ebi.ac.uk/vol1/fastq/ERR202/001/ERR2020611/ERR2020611.fastq.gz
ftp.sra.ebi.ac.uk/vol1/fastq/ERR202/007/ERR2020567/ERR2020567.fastq.gz
ftp.sra.ebi.ac.uk/vol1/fastq/ERR202/005/ERR2020565/ERR2020565.fastq.gz
#ftp.sra.ebi.ac.uk/vol1/fastq/ERR202/001/ERR2020601/ERR2020601.fastq.gz
ftp.sra.ebi.ac.uk/vol1/fastq/ERR202/003/ERR2020613/ERR2020613.fastq.gz
ftp.sra.ebi.ac.uk/vol1/fastq/ERR202/008/ERR2020618/ERR2020618.fastq.gz
ftp.sra.ebi.ac.uk/vol1/fastq/ERR202/007/ERR2020617/ERR2020617.fastq.gz
```

---

# Zoom zoom zoom!

Now to download all the files stored in the URLs. IN ONE GO! 

<p align="center">
  <img title="Source: https://giphy.com/gifs/aliens-oAEoEC7vdf1QI" src="https://media.giphy.com/media/oAEoEC7vdf1QI/giphy.gif" width="30%">
</p>

--

As before: 
  - give a file to `wget` with URLs with the flag `-i`, for "**i**nput". 

```bash
cd ~/BareBonesBash
wget -i ~/BareBonesBash/Ftp.Links.txt

```

---

class: center,middle
# Laziness 101: Minimising our work by maximising the work of the computer

### What is a variable anyway?

---

# Tangent Nr. 2

How not feel lonely - make the computer talk back to you with `echo`

```bash
$ echo Hello World!
```

--

```
Hello World!
```

<p align="center">
  <img title="Source: https://giphy.com/gifs/SpongeBobMovie-spongebob-squarepant-PnUatAYWMEMvmiwsyx" src="https://media.giphy.com/media/PnUatAYWMEMvmiwsyx/giphy.gif" width = "30%">
</p>

---

# Home sweet home...

A variable is a container
  - Begins with `$` with no space between some characters
  - The name of the variable stays the same, the contents _changes_

--

.left-column-33[
Try `echo`ing HOME

```bash
$ echo HOME
```

```
home
```
]

--

.right-column-66[
<p align="center">
  <img title="Source: https://giphy.com/gifs/home-explosm-h4BLlvyUM2CVFK683U" src="https://media.giphy.com/media/h4BLlvyUM2CVFK683U/giphy.gif" width = "80%">
</p>
]

--

.left-column-33[
Now try `echo`ing home as a variable 

```bash
$ echo $HOME
```
```
/home/james/
```
]

---

# Klaxon alert!

- Variables as the one above are called **environment variables**

--

- Typically in $ALL_CAPS

--

- Defined by your default computer environment

--

- Should generally **NOT** be changed on a whim 

\[_even though the temptation might be a whim away. A whim away... A-whim-away..._\].

<p align="center"><img title="Source: http://en.webfail.com/e91115df851" src="http://cdn.webfail.com/upl/img/e91115df851/post2.jpg" width="50%"></p>

---

# Making your own

.left-column[
- Any variable can be easily overwritten, which is one reason why they are so useful.
]

--


.left-column[
- To assign your own variable, 
  - Write variable name
  - Then the `=` symbol. 
  - And the contents of the variable
]

--

<p align="center">
  <img title="Source: http://visitgreece-gr.tumblr.com/" src="https://78.media.tumblr.com/04ac7d0699ac494a7ccb4fc9316bbc0a/tumblr_oo77m9RLgv1uwr1s7o1_500.gif" width="25%">
</p>
<p align="center"><i>And now for a trip...</i></p>

---


```bash
$ GreekFood=4            #Here, 'GreekFood' is a number.
$ echo "Greek food is $GreekFood people who want to know what heaven tastes like."
```

--

```
Greek food is 4 people who want to know what heaven tastes like.
```

--

```bash
$ GreekFood=delicious   #Now we overwrite that number with a word (or a "string" of characters).
$ echo "Everyone says that Greek food is $GreekFood."
```
--

```
Everyone says that Greek food is delicious.

```

--

```bash
$ GreekFood="Greek wine" #We can overwrite 'GreekFood' again, but when there is a space in our string, we need quotations.
$ echo "The only thing better than Greek food is $GreekFood!"
```

--

```
The only thing better than Greek food is Greek wine!
```

--

```bash
$ GreekFood=7 #And, of course, we can overwrite with a number again too.
$ echo "I have been to Greece $GreekFood times already this year, for the food and wine!"
```

--

```
I have been to Greece 7 times already this year, for the food and wine!

```

---

class: center,middle
# Laziness 101: Minimising our work by maximising the work of the computer

### Loop de Loop?

---

# I'm running out of bad titles...

Back to being lazy 
- how to make symlinks for each FASTQ file, without writing the command 7 times?

--

We do this with a `for` loop.
- for each element in a list, do something

--

.left-column[

In pseudo-code

```
## Don't copy this, it will not work.
for every scientist:
  Order another pizza
done
```
]

.right-column[

<p align="center">
  <img title="Source: https://tenor.com/view/izza-oprah-eatwhatyouwant-gif-4149888" src="https://media1.tenor.com/images/5ef4336be26e478431f85b349ec6bd34/tenor.gif?itemid=4149888" width="60%">
</p>
]

---

# Enough pizza, back to mammoths!

- Our loop:
  - For a given list of files
  - Do a symbolic link command for each one
  - Stop when there are no more files

--

```bash
$ for fastq in ERR2020609.fastq.gz ERR2020611.fastq.gz ERR2020567.fastq.gz ERR2020565.fastq.gz ERR2020613.fastq.gz ERR2020618.fastq.gz ERR2020617.fastq.gz; do 
    ln -s ~/BareBonesBash/$fastq ~/BareBonesBash/FastQ.Portals
  done
```

--

**Bonus tip time!** `ls` will also accept a path to look into!

```bash
$ ls -l FastQ.Portals/

```

--

```
total 0
lrwxrwxrwx 1 fellows jamesfellowsyates 47 Nov 16 16:25 ERR2020565.fastq.gz -> /home/fellows/BareBonesBash/ERR2020565.fastq.gz
lrwxrwxrwx 1 fellows jamesfellowsyates 47 Nov 16 16:25 ERR2020567.fastq.gz -> /home/fellows/BareBonesBash/ERR2020567.fastq.gz
lrwxrwxrwx 1 fellows jamesfellowsyates 47 Nov 16 16:25 ERR2020609.fastq.gz -> /home/fellows/BareBonesBash/ERR2020609.fastq.gz
lrwxrwxrwx 1 fellows jamesfellowsyates 47 Nov 16 16:25 ERR2020611.fastq.gz -> /home/fellows/BareBonesBash/ERR2020611.fastq.gz
lrwxrwxrwx 1 fellows jamesfellowsyates 47 Nov 16 16:25 ERR2020613.fastq.gz -> /home/fellows/BareBonesBash/ERR2020613.fastq.gz
lrwxrwxrwx 1 fellows jamesfellowsyates 47 Nov 16 16:25 ERR2020617.fastq.gz -> /home/fellows/BareBonesBash/ERR2020617.fastq.gz
lrwxrwxrwx 1 fellows jamesfellowsyates 47 Nov 16 16:25 ERR2020618.fastq.gz -> /home/fellows/BareBonesBash/ERR2020618.fastq.gz

```

---

## Hold up...!

We're meant to be lazy! Not writing the name of each FASTQ file!

--

Instead we can use **wildcards** 
 - "refers to a character that can be substituted for zero or more characters in a string". 
 - In bash, the wildcard character is the asterisk (`*`) 
_\[Not to be confused with Asterix, James. AGAIN, REALLY!?)]_. 

<p align="center">
  <img title="Source: https://www.garethjmsaunders.co.uk/2008/01/29/asterix-and-asterisk/" src="https://www.garethjmsaunders.co.uk/wp-content/uploads/2008/01/asterix_or_asterisk.gif" width="30%"><br /><i> [Take note James...] </i>
</p>

---

# This means: SHORTCUTS!

<p align="center">
  <img title="Source: https://giphy.com/gifs/mario-kart-shortcut-rainbow-road-1385h22r1k6sIU" src="https://media.giphy.com/media/1385h22r1k6sIU/giphy.gif" width="20%">
</p>

In the context of a loop, we can use the `*` to perform an action on all items in
a directory!

--

```bash
$ for fastq in ~/BareBonesBash/ERR*; do
    ln -s $fastq ~/BareBonesBash/FastQ.Portals
  done

```
--

Don't want literally everything? All files beginning with ERR:

```bash
$ for fastq in ~/BareBonesBash/ERR*; do
    ln -s $fastq ~/BareBonesBash/FastQ.Portals
  done

```

???

In the context of a loop, we can use the wildcard to tell bash the loop 
should be performed on ALL items in a directory that match the criterion given. 

If we want to create a symlink (with `ln -s`) for every item within the 
`~/BareBonesBash` directory, and place that symlink within the 
`~/BareBonesBash/FastQ.Portals` directory, we could use: 

---

# Combine with everything!

A wildcard can be added anywhere! Making the computer to do the hard work for you

.left-column-66[
```bash
$ for fastq in ~/BareBonesBash/ERR*.gz; do
    gzip -l $fastq
  done

```
]

.right-column-33[
<p align="center">
  <img title="Source: https://giphy.com/gifs/tinder-automation-tinderbot-3rgXByefj5zvCcodOM" src="https://media.giphy.com/media/3rgXByefj5zvCcodOM/giphy.gif" width="90%">
</p>
]

--

# Over to you

Look inside `~/BareBonesBash/FastQ.Portals`
  - Are only your FASTQ files inside?

--

**Try writing your own loop using `for`, `*`, and `rm` to remove ONLY the non-FASTQ files!**


???

If you need to be more specific with your loop, you can also use the wildcard
with some other characters. 

For example, `ERR*` would mean perform a command on every file that begins with 
ERR, regardless of what comes after ERR. 

Finally, we can use characters AFTER the wildcard as well, to only pick up 
files that have a certain suffix as well as prefix (e.g. `ERR*.gz` will find 
all files that begin with `ERR` and end with `.gz`, regardless of what (if 
anything) comes between the two).


As a final practice, have a look inside your `~/FastQ.Portals` directory. 

You might notice that you have also symlinks to `FastQ.Portals` and `Ftp.Links.txt`
as well as our FastQ files. 

These came in our previous `ln -s` loop, as we 
used the wildcard for _everything_ in `~/BareBonesBash`. 



---

class: center,middle

# The road so far

---

# Woohoo!

Well done **you** for putting up with an inordinate amount of internet memes, gifs, terrible pop-culture, and video game references!

<p align="center">
  <img title="Source: https://giphy.com/gifs/csi-miami-horatio-caine-xPGkOAdiIO3Is" src="https://media1.giphy.com/media/xPGkOAdiIO3Is/giphy.gif" width="30%"> 
  <img title="Source: https://giphy.com/gifs/swag-80s-sunglasses-62PP2yEIAZF6g" src="https://media.giphy.com/media/62PP2yEIAZF6g/giphy-downsized.gif" width="40%">
</p>

--

You should now feel more comfortable:
  - how to move around using the Terminal, 
  - using basic commands to view, create, and manipulate files and directories.
  - understanding what a `for` loop is


---

class: center,middle

# The Cleanup Crew

---

# Enter the janitor!

Despite being lazy - you should ALWAYS keep your room tidy.

- This stops losing files
- Prevents getting lost in a maze of directories
- Accidently permanently deleting a days worth of work \[_don't ask how many times this happens_\].

--

.left-column[
Lets remove:
  - the  `~/BareBonesBash` directory 
  - **all of its contents**. 

```bash
$ cd ~     # Don't delete a directory 
         # while we are still in it! 
$ rm -r ~/BareBonesBash
```
]

--

.right-column[
<p align="center">
  <img title="Source: https://i.imgur.com/lcxyE0D.gif" src="https://i.imgur.com/lcxyE0D.gif" width="80%">
</p>
]

---



# Thanks to...

- Stephan Schiffels 
  - for loaning us his cluster and the cool passwords
- Aida Andrades Valuteña 
  - for suggestions/ideas 
  - protecting James' daughter from dying of future embarrassement.

--

## Next time

.left-column[
<p align="center">
  <img title="Source: https://giphy.com/gifs/kimmyschmidt-unbreakable-kimmy-schmidt-3o72FiJGth3gp4jhUA" src="https://media.giphy.com/media/3o72FiJGth3gp4jhUA/giphy.gif" width="70%">
</p>

<p align="center" >
  <i>[HAHAHAHA! jk.]</i>
</p>
]

.right-column[
* advanced echo
* rev
* cut
* find
* awk
* sed
* while loops
* if statements

]

    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create({
      slideNumberFormat: (current, total) => `
        <div class="progress-bar-container">
          <div class="progress-bar" style="width: ${current/total*100}%">
          </div>
        </div>
      `
    });
    </script>
  </body>
</html>